<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ステラソラ 実績クリアチェッカーα</title>
    <style>
        :root {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --text-color: #e0e0e0;
            --accent-color: #4a90e2;
            --gray-done: #333333;
            --border-color: #444;
            --success-color: #2ecc71;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0; padding: 20px;
            display: flex; flex-direction: column; align-items: center;
        }

        .container { width: 100%; max-width: 900px; }
        h1 { text-align: center; color: var(--accent-color); margin-bottom: 10px; }

        .total-progress-area {
            background: #252525; padding: 20px; border-radius: 12px; margin-bottom: 20px;
            border: 2px solid var(--accent-color); text-align: center;
        }

        .total-stats { font-size: 1.2rem; font-weight: bold; margin-bottom: 10px; display: block; }

        .toolbar {
            background: var(--card-bg); padding: 15px; border-radius: 8px; margin-bottom: 20px;
            display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;
            border: 1px solid var(--border-color); position: sticky; top: 10px; z-index: 100;
        }

        .toolbar label { cursor: pointer; font-size: 0.9rem; display: flex; align-items: center; gap: 8px; }

        .category { margin-bottom: 15px; border: 1px solid var(--border-color); border-radius: 8px; overflow: hidden; background: var(--card-bg); }
        .category-header { padding: 15px 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; background: #252525; transition: background 0.3s; }
        .category-header:hover { background: #2d2d2d; }

        .progress-wrapper { flex-grow: 1; margin: 0 20px; display: flex; align-items: center; gap: 10px; }
        .progress-container { flex-grow: 1; background: #444; height: 14px; border-radius: 7px; position: relative; overflow: hidden; }
        .progress-bar { background: var(--accent-color); height: 100%; width: 0%; transition: width 0.4s ease; }
        .progress-bar.complete { background-color: var(--success-color) !important; }
        .pct-label { font-size: 0.85rem; min-width: 45px; text-align: right; font-family: monospace; }

        .category-content { display: none; padding: 0; border-top: 1px solid var(--border-color); }
        .category.open .category-content { display: block; }

        .achievement-item {
            padding: 12px 20px; border-bottom: 1px solid #333; display: grid;
            grid-template-columns: auto 1fr; gap: 15px; align-items: center; transition: background 0.2s;
        }
        .achievement-item.done { background-color: var(--gray-done); }
        .achievement-item.hidden { display: none; }
        .achieve-info h4 { margin: 0 0 5px 0; color: var(--accent-color); font-size: 1rem; }
        .achieve-info p { margin: 2px 0; font-size: 0.85rem; color: #bbb; }
        .reward { color: #ffd700 !important; font-weight: bold; }

        footer { margin-top: 40px; padding: 20px; text-align: center; border-top: 1px solid var(--border-color); font-size: 0.8rem; color: #888; line-height: 1.6; }
        #congrats-msg { display: none; background: linear-gradient(45deg, #2ecc71, #27ae60); color: white; padding: 15px; border-radius: 8px; margin-top: 15px; font-weight: bold; animation: pulse 2s infinite; }

        @keyframes pulse { 0% { opacity: 0.9; } 50% { opacity: 1; transform: scale(1.02); } 100% { opacity: 0.9; } }
        input[type="checkbox"] { transform: scale(1.4); cursor: pointer; }
        #reset-btn { background: #d9534f; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>

<div class="container">
    <h1>ステラソラ 実績チェッカーα</h1>

    <div class="total-progress-area">
        <span class="total-stats">全実績 合計進捗: <span id="total-count">0/0</span></span>
        <div class="progress-wrapper">
            <div class="progress-container">
                <div id="total-bar" class="progress-bar"></div>
            </div>
            <span id="total-pct" class="pct-label" style="font-size: 1.1rem;">0%</span>
        </div>
        <div id="congrats-msg">✨ おめでとうございます！すべての実績をコンプリートしました！ ✨</div>
    </div>

    <div class="toolbar">
        <label><input type="checkbox" id="sort-undone"> 未達成を上位に表示</label>
        <label><input type="checkbox" id="hide-done"> 達成済みを非表示</label>
        <button id="reset-btn">全てのデータをリセット</button>
    </div>

    <div id="app"></div>

    <footer>
        <p>本ツールはステラソラ二次創作ガイドラインに沿って制作されたファンメイドコンテンツです。Yoster社とは関係ありません。</p>
        <p>本ツールは予告なしに利用を終了する場合があります</p>
        <p>こちらに関するお問い合わせ・要望、また、欠けている実績の情報提供等も大歓迎です！</p>
        <p>メール: ioritoku108@gmail.com | Discord: iori108</p>
    </footer>
</div>

<script>
    const ROMAN = ["", "I", "II", "III", "IV", "V", "VI", "VII", "VIII", "IX", "X"];

    const achievementData = [
        {
            category: "世界を探索",
            items: [
                ...[5,10,15,20,25,30,40].map((n, i) => ({ id: 101+i, name: `魔王の道 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `権限レベルが${n}に到達する` })),
                ...[10,20,30,50,100].map((n, i) => ({ id: 110+i, name: `一日一善 ${ROMAN[i+1]}`, reward: i === 4 ? "星ノ欠片 20" : "星ノ欠片", condition: `${n}日ログインする` })),
                ...[10,50,500,1000,3000].map((n, i) => ({ id: 120+i, name: `思わぬ成果 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `合成を${n}回行う` })),
                ...[50,100,150,200].map((n, i) => ({ id: 130+i, name: `順風満帆 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `実績を${n}件達成する` })),
                ...[100000,600000,3000000,10000000,30000000].map((n, i) => ({ id: 140+i, name: `太っ腹 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `${n.toLocaleString()}ドーラを消費する` })),
                ...[600,2000,5000,10000,24000].map((n, i) => ({ id: 150+i, name: `星のキラメキ ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `入塔記念チケットを${n.toLocaleString()}枚消費する` })),
                ...[5,10,20,30,50,70].map((n, i) => ({ id: 160+i, name: `カンパニー拡大中 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `ガチャで巡遊者を${n}回獲得する` })),
                ...[50,100,200,300,400,500].map((n, i) => ({ id: 170+i, name: `積極採用 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `ガチャを${n}回行う` })),
                ...[1,2,3,4,5,6,7,8,9].map(i => ({ id: 180+i, name: `千里の道も一歩から ${ROMAN[i]}`, reward: "星ノ欠片", condition: `魔王育成第${i}章をクリアする` })),
                ...[10,20,30,100,200,500].map((n, i) => ({ id: 190+i, name: `頼れる助っ人 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `依頼を${n}回完了する` })),
                { id: 201, name: "駆け出し巡遊者", reward: "星ノ欠片 10", condition: "原初の迷路と他の星の塔を各1回クリアする" },
                { id: 202, name: "アッシュエリアの風", reward: "名誉称号", condition: "メインストーリー第一章をクリアする" },
                { id: 203, name: "水道橋の英雄", reward: "名誉称号", condition: "メインストーリー第二章をクリアする" },
                { id: 204, name: "花咲サポーター", reward: "名誉称号", condition: "メインストーリー第三章をクリアする" },
                { id: 205, name: "ユメカウツツカ", reward: "星ノ欠片 5", condition: "メインストーリー「未来のない巡遊者」をクリアする" },
                { id: 206, name: "安定雇用", reward: "星ノ欠片 5", condition: "メインストーリー「変わらないもの」をクリアする" },
                { id: 207, name: "甘い罠", reward: "名誉称号", condition: "メインストーリー第四章をクリアする" },
                { id: 208, name: "MVP従業員", reward: "名誉称号", condition: "メインストーリー第五章をクリアする" },
                { id: 209, name: "夜と彩る銀の星", reward: "名誉称号", condition: "メインストーリー第六章をクリアする" }
            ]
        },
        {
            category: "星狩りの旅",
            items: [
                { id: 301, name: "視界不良", reward: "星ノ欠片 10", condition: "原初の迷路を1回クリアする" },
                ...[1,2,3,4,5,6,7].map(i => ({ id: 310+i, name: `水面に沈む ${ROMAN[i]}`, reward: "星ノ欠片", condition: `流水と暗影の難易度${i}を1回クリアする` })),
                ...[1,2,3,4,5,6,7].map(i => ({ id: 320+i, name: `灼熱の大地 ${ROMAN[i]}`, reward: "星ノ欠片", condition: `烈火と泥鉱の難易度${i}を1回クリアする` })),
                ...[1,2,3,4,5,6,7].map(i => ({ id: 330+i, name: `大気を裂く雷 ${ROMAN[i]}`, reward: "星ノ欠片", condition: `暴風と雷光の難易度${i}を1回クリアする` })),
                ...[2,4,6,7].map((n, i) => ({ id: 340+i, name: `手広く対応 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `3つの星ノ塔で難易度${n}をクリアする` })),
                ...[3,10,30,50,100].map((n, i) => ({ id: 350+i, name: `習うより慣れろ ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `星ノ塔を${n}回クリアする` })),
                ...["水","火","地","風","光","闇"].flatMap((attr, idx) => [5,10,20,50].map((n, i) => ({ id: 3000+(idx*10)+i, name: `${attr}のエキスパート ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `${attr}属性のみのチームで星ノ塔を${n}回クリアする` }))),
                ...["強撃","幸運","爆発","体力","集中","器用","必殺","水","火","風","地","光","闇"].flatMap((note, idx) => [100,500,1200,3000,5000].map((n, i) => ({ id: 4000+(idx*10)+i, name: `絶対音感・${note} ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `星ノ塔で${note}の音符を${n}個獲得する` }))),
                ...[10,50,200,500,1000,1600,2200,2800,4000,6000].map((n, i) => ({ id: 3100+i, name: `コンビニの常連 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `星ノ塔のコンビニで${n}回買い物する` })),
                ...[20,60,150,300,450,600,750,900,1200,1500].map((n, i) => ({ id: 3200+i, name: `偶然の出会い ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `星ノ塔でイベントを${n}回発生させる` })),
                ...[2000,60000,140000,350000,650000,999999].map((n, i) => ({ id: 3300+i, name: `大富豪 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `星ノ塔でステラコインを${n}枚獲得する` })),
                ...[1,6,30,90,200,300,400,500,700,1000].map((n, i) => ({ id: 4900+i, name: `ロスレコ共鳴 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `星ノ塔でロスレコのアシスト効果を${n}回解放する` }))
            ]
        },
        {
            category: "戦果累々",
            items: [
                ...[20,40,80,240].map((n, i) => ({ id: 501+i, name: `切磋琢磨 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `技能研修を${n}回クリアする` })),
                ...[20,40,80,240,480].map((n, i) => ({ id: 511+i, name: `熟練の技 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `昇格試練を${n}回クリアする` })),
                ...["水","火","地","風","光","闇"].flatMap((attr, idx) => [10,50,100,300,500,1000].map((n, i) => ({ id: 8000+(idx*10)+i, name: `${attr=='水'?'絶え間なき奔流':attr=='火'?'燃え上がる烈火':attr=='地'?'鳴動する大地':attr=='風'?'うずまく風':attr=='光'?'まばゆい光':'深き闇夜'} ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `${attr}属性の印を${n}回発動する` }))),
                ...[10,20,50,100,300,500,1000].map((n, i) => ({ id: 9000+i, name: `究極奥義 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `必殺技を${n}回発動する` })),
                { id: 11503, name: "至高の一撃 III", reward: "星ノ欠片 20", condition: "一回の攻撃で999999以上のダメージを与える" }
            ]
        },
        {
            category: "鍛錬の成果",
            items: [
                ...[10,20,30,40,50].map((n, i) => ({ id: 14001+i, name: `世渡り上手 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `巡遊者の昇格を${n}回行う` })),
                ...[20,30,50,90].map((lv, i) => ({ id: 14201+i, name: `精鋭揃い ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `巡遊者3人をLv.${lv}にする` })),
                { id: 14205, name: `精鋭揃い V`, reward: "星ノ欠片", condition: `巡遊者6人をLv.90にする` },
                { id: 14206, name: `精鋭揃い VI`, reward: "星ノ欠片", condition: `巡遊者9人をLv.90にする` },
                ...["水","火","地","風","光","闇"].flatMap((attr, idx) => [20,30,50,90].map((lv, i) => ({ id: 14300+(idx*10)+i, name: `${attr}の専門家 ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `${attr}属性の巡遊者3人をLv.${lv}にする` }))),
                ...[3,10,15,20].map((n, i) => ({ id: 14901+i, name: `努力あるのみ ${ROMAN[i+1]}`, reward: "星ノ欠片", condition: `巡遊者${n}人のスキルを${n==20?'Lv.7':'Lv.4'}以上に強化する` }))
            ]
        }
    ];

    let status = JSON.parse(localStorage.getItem('stella-sora-full-final-v5')) || {};
    let openCategories = {};

    function render() {
        const app = document.getElementById('app');
        const sortUndone = document.getElementById('sort-undone').checked;
        const hideDone = document.getElementById('hide-done').checked;

        document.querySelectorAll('.category').forEach((el, idx) => { openCategories[idx] = el.classList.contains('open'); });

        app.innerHTML = '';
        let totalItemsCount = 0;
        let totalDoneCount = 0;

        achievementData.forEach((cat, index) => {
            const count = cat.items.length;
            const doneCount = cat.items.filter(i => status[i.id]).length;
            const pct = count > 0 ? Math.floor((doneCount / count) * 100) : 0;
            const isComplete = (doneCount === count && count > 0);

            totalItemsCount += count;
            totalDoneCount += doneCount;

            const catDiv = document.createElement('div');
            catDiv.className = 'category';
            if (openCategories[index]) catDiv.classList.add('open');

            let displayItems = [...cat.items];
            if (sortUndone) { 
                displayItems.sort((a, b) => (status[a.id] === status[b.id] ? 0 : status[a.id] ? 1 : -1)); 
            }

            const itemsHtml = displayItems.map(item => {
                const isItemDone = status[item.id] || false;
                return `
                    <div class="achievement-item ${isItemDone ? 'done' : ''} ${isItemDone && hideDone ? 'hidden' : ''}">
                        <input type="checkbox" ${isItemDone ? 'checked' : ''} onchange="toggleAchievement(${item.id})">
                        <div class="achieve-info">
                            <h4>${item.name}</h4>
                            <p class="reward">報酬: ${item.reward}</p>
                            <p>${item.condition}</p>
                        </div>
                    </div>
                `;
            }).join('');

            catDiv.innerHTML = `
                <div class="category-header" onclick="toggleCategory(this, ${index})">
                    <strong>${cat.category} (${doneCount}/${count})${isComplete?' <span style="color:#2ecc71">★</span>':''}</strong>
                    <div class="progress-wrapper">
                        <div class="progress-container">
                            <div class="progress-bar ${isComplete?'complete':''}" style="width: ${pct}%"></div>
                        </div>
                        <span class="pct-label" style="color:${isComplete?'var(--success-color)':'inherit'}">${pct}%</span>
                    </div>
                    <span>▼</span>
                </div>
                <div class="category-content">${itemsHtml}</div>
            `;
            app.appendChild(catDiv);
        });

        const totalPct = totalItemsCount > 0 ? Math.floor((totalDoneCount / totalItemsCount) * 100) : 0;
        const totalComplete = (totalDoneCount === totalItemsCount && totalItemsCount > 0);
        document.getElementById('total-count').textContent = `${totalDoneCount} / ${totalItemsCount}`;
        const totalBar = document.getElementById('total-bar');
        totalBar.style.width = `${totalPct}%`;
        if(totalComplete) totalBar.classList.add('complete'); else totalBar.classList.remove('complete');
        document.getElementById('total-pct').textContent = `${totalPct}%`;
        document.getElementById('congrats-msg').style.display = totalComplete ? 'block' : 'none';
    }

    window.toggleCategory = (el, index) => {
        const p = el.parentElement;
        p.classList.toggle('open');
        openCategories[index] = p.classList.contains('open');
    };

    window.toggleAchievement = (id) => {
        status[id] = !status[id];
        localStorage.setItem('stella-sora-full-final-v5', JSON.stringify(status));
        render();
    };

    document.getElementById('reset-btn').onclick = () => {
        if(confirm('注意：全ての進捗データが削除されます。よろしいですか？')) {
            status = {};
            localStorage.setItem('stella-sora-full-final-v5', JSON.stringify(status));
            render();
        }
    };

    document.getElementById('sort-undone').onchange = render;
    document.getElementById('hide-done').onchange = render;
    render();
</script>
</body>
</html>
